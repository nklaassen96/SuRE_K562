---
title: "Journal"
author: "Noud Klaassen"
output: html_document
---

---
title: "Test"
---
## Week 1
#### 15-08-2019 (Th)
VCF-files of K562 have been loaded in RStudio (non-phased) via the `wget` command in Linux. Exploratory analyses on the nr. of SNPs per chromosome, average QUAL-scores.

#### 16-08-2019 (Fr)
Received feedback from Ludo on the `RMarkdown`-file that was created. Some more exploratory analysese were performed

## Week 2
#### 26-08-2019 (Mo)
I generated a RProject for the K562_SuRE directory. I linked the files to the GitHub repository which I will commit every day at the end of the day. Also I started exploring the uniqueness in the MNVs that I have found. It seems that 0 MNVs start at the same position, but 0.5% of MNVs have some overlap with other MNVs

#### 27-08-2019 (Tu)
I to find a way to identify overlapping Indels and SNVs. I made a function that was able to do this up to 50.000 rows at a time (which is not enough). Variants were annotated with the `TxDb.Hsapiens.UCSC.hg19.knownGene`-package (supplying the transcript database) and the `VariantTools`-package (allowing for variant identification)

#### 28-08-2019 (We)
Exploratory analysis to identify SNVs, new vs known variants without the use of extra packages. Talked with Bas & Ludo about the project. Need to filter heterozygotes and generate a distributionplot of the location of mutations on a chromosome

#### 29-08-2019 (Th)
I rewrote the whole `20190823_VariantCalling.R`-script. Primarily all information (e.g. new vs known variant) was put into a new `GRanges` object. With the new script, all this information is stored within the metadata of the same `GRanges` object. The desired objects can therefore easily be filtered out by using boolean arguments. Also started on the visualization of data using a distribution plot. For this I used the `karyoploteR` function. 

#### 30-08-2019 (Fr)
Tried to annotate transcription factor binding domains. Didn't work because the `MotIV`-package required GSL which was hard to install and link properly. Installed conda on the server. Got the dotplot function of the `KaryoplotR` working.

## Week 3
#### 02-09-2019 (Mo)
Tried some more `KaryoplotR` functions. I wanted to annotate the genomic positions with Transcription Factor Binding Sites (TFBS). Therefore i downloaded the `RegulomeDB.dbSNP138`. However, this database could not be loaded in R. Also, it only contains information on SNPs present in the dbSNP.

#### 03-09-2019 (Tu)
Tried to find a way to count the total number of exons in the genes etc.

#### 04-09-2019 (We)
I found a way to remove duplicates from the Variantannotation. In this way, 104% of variants is represented, indicating still some overlap between various variants. This could e.g. be a promoter within an intergenic region etc. Also started exploring heterozygotic mutations in regions with Loss of Heterozygosity (LOH). Strangely, there are still a lot of heterozygotic mutations in these regions. 

#### 05-09-2019 (Th)
It turns out that the VCF-file from the K562-paper doesn't correctly annotate the genotype. In regions that have loss of heterozygosity (e.g. chromosome 13 and 14), the genotype is often described as 1/1 (homozygote for the alternative allele), while there would be only 1 allele. This is a problem as we are mostly interested in heterozygous mutations. Regions with CN = 1 should therefore be discarded. 

#### 06-09-2019 (Fr)
I compared phased and non-phased data from the K562-paper. There are minimal differences, we choose to continue with the phased data. Wrote a script to generate the right vcf-files and the right txt files. Successfully generated these files with the `20190906_PreparingVCF` script
```{r, echo = F}
library(knitr)
Files = c("VCF files", "Txt files (All)", "Txt files (New)")
Type = c(".vcf.gz", ".txt",".txt")
Variants = c("All", "All", "New")
Overlap = c("No", "No", "No")
Directory = c("~/projects/SuRE_K562/data/interim/SNPs/vcf", "~/projects/SuRE_K562/data/interim/SNPs/txt", "~/projects/SuRE_K562/data/interim/SNPs/txt")
df = data.frame(Files, Type, Variants, Overlap, Directory)
kable(df)
```

### Week 4

#### 09-09-2019 (Mo)
I downloaded `bed_files.tar.gz` from `http://jaspar.genereg.net/download/bed_files.tar.gz` to function as a database for transcription factor binding sites. I previously did the same with `RegulomeDB.dbSNP132.Category3.txt` from `http://www.regulomedb.org/downloads/RegulomeDB.dbSNP132.Category3.txt.gz`, but this file could not be loaded into R. `MA1198.1.bed` was removed by using the MobaXterm as it contains no data. 

#### 10-09-2019 (Tu)
I got the bedfiles annotation of the TFBS working for the `GRanges` file. Able to generate a `GRanges` file with all novel mutations and the corresonding number of the file of the TFBS they interfere with. Mind that mutations that alter multiple TFBS occur in multiple rows. For the SuRE-pipeline, I resolved a few errors regarding the SNPs database annotation. We use the non-phased files. Important to go to the conda environment of K562_SuRE, otherwise, python is not correctly installed (`conda activate K562_SuRE`)